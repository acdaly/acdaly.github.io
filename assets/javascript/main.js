// Variables for HandleBar Template: To load Portfolio project titles

var featured = {
    "projects": [
        

        
{
            "name": "teamLab River Prototype",
            "img": "assets/images/featured/7.jpg",
            "id": "river",
            "modalID": "river-modal"
        },

       
        {
            "name": "Light Prototype",
            "img": "assets/images/featured/1.jpg",
            "id": "google-prototype",
            "modalID": "google-modal"
        },
        {
            "name": "Searching",
            "img": "assets/images/featured/searching.png",
            "id": "searching",
            "modalID": "searching-modal"
        },
        
        
        
        {
            "name": "Cramp",
            "img": "assets/images/featured/cramp.png",
            "id": "cramp",
            "modalID": "cramp-modal"
        },
        
         
        {
            "name": "Entanglement",
            "img": "assets/images/featured/4.jpg",
            "id": "entanglement",
            "modalID": "entanglement-modal"
        }
        
        
        
        
        
        
        
    ]     
}

var design = {
    "projects": [
        {
            "name": "Swift Shift",
            "img": "assets/images/design/swift_shift.jpg",
            "id": "shift",
            "modalID": "shift-modal"
        },
        {
            "name": "Transportation Display",
            "img": "assets/images/design/ptf.jpg",
            "id": "ptf",
            "modalID": "ptf-modal"
        },
        
        {
            "name": "CMU To Go",
            "img": "assets/images/design/foodtruck-thumbnail.jpg",
            "id": "foodtruck",
            "modalID": "foodtruck-modal"
        },
        
        
        {
            "name": "Portfolio Website",
            "img": "assets/images/design/portfolio.jpg",
            "id": "portfolio-doc",
            "modalID": "portfolio-modal"
        }
        
        
        
        
    ]     
}

var creativeFrameworks = {
    "projects": [
        {
            "name": "Sandblox",
            "img": "assets/images/coding/sandblox.jpg",
            "id": "sandblox",
            "modalID": "sandblox-modal"
        },
        {
            "name": "Plotter Drawing",
            "img": "assets/images/coding/plotter.jpg",
            "id": "plotter",
            "modalID": "plotter-modal"
        },
        {
            "name": "Fireflies",
            "img": "assets/images/coding/fireflies.jpg",
            "id": "fireflies",
            "modalID": "fireflies-modal"
        },
        {
            "name": "Surround Sounds",
            "img": "assets/images/coding/surround-sounds.jpg",
            "id": "surround-sounds",
            "modalID": "surround-modal"
        },
        {
            "name": "P5 Experiments",
            "img": "assets/images/coding/p5-experiments.jpg",
            "id": "p5-experiments",
            "modalID": "p5-modal"
        }
    ]     
}

var hardware = {
    "projects": [
        {
            "name": "Light Prototype",
            "img": "assets/images/coding/google-prototype.jpg",
            "id": "google-prototype",
            "modalID": "google-modal"
        },
        {
            "name": "LED Controller",
            "img": "assets/images/coding/led-controller.jpg",
            "id": "led-controller",
            "modalID": "led-modal"
        },
        {
            "name": "Entanglement",
            "img": "assets/images/coding/entanglement.jpg",
            "id": "google-prototype",
            "modalID": "entanglement-modal"
        },
        {
            "name": "Light Capsule",
            "img": "assets/images/coding/light-capsule.jpg",
            "id": "light-capsule",
            "modalID": "capsule-modal"
        }
    ]     
}

var fabrication = {
    "projects": [
        {
            "name": "Light Prototype",
            "img": "assets/images/fabrication/google-prototype.jpg",
            "id": "google-prototype",
            "modalID": "google-modal"
        },
        {
            "name": "Entanglement",
            "img": "assets/images/fabrication/entanglement.jpg",
            "id": "entanglement",
            "modalID": "entanglement-modal"
        },
        {
            "name": "Holder & Coaster",
            "img": "assets/images/fabrication/holder.jpg",
            "id": "holder-coaster",
            "modalID": "holder-modal"
        },
        {
            "name": "Within Our Reach",
            "img": "assets/images/fabrication/swing.jpg",
            "id": "swing",
            "modalID": "swing-modal"
        },
        {
            "name": "Enclosed",
            "img": "assets/images/fabrication/enclosed.jpg",
            "id": "enclosed",
            "modalID": "enclosed-modal"
        },
        {
            "name": "Memories",
            "img": "assets/images/fabrication/memories.jpg",
            "id": "memories",
            "modalID": "memories-modal"
        }
    ]     
}

var dFab = {
    "projects": [
        {
            "name": "Google Light Prototype",
            "img": "assets/images/fabrication/google-prototype.jpg",
            "id": "google-prototype",
            "modalID": "google-modal"
        },
        {
            "name": "Entanglement",
            "img": "assets/images/fabrication/entanglement.jpg",
            "id": "entanglement",
            "modalID": "entanglement-modal"
        },
        {
            "name": "Holder & Coaster",
            "img": "assets/images/fabrication/holder.jpg",
            "id": "holder-coaster",
            "modalID": "holder-modal"
        },
        {
            "name": "Cast a Keychain",
            "img": "assets/images/fabrication/keychain.jpg",
            "id": "swing",
            "modalID": "swing-modal"
        },
        {
            "name": "Eclipse",
            "img": "assets/images/fabrication/eclipse.jpg",
            "id": "eclipse",
            "modalID": "eclipse-modal"
        }
    ]     
}

var woodMetal = {
    "projects": [
        {
            "name": "Within Our Reach",
            "img": "assets/images/fabrication/swing.jpg",
            "id": "swing",
            "modalID": "swing-modal"
        },
        {
            "name": "Enclosed",
            "img": "assets/images/fabrication/enclosed.jpg",
            "id": "enclosed",
            "modalID": "enclosed-modal"
        },
        {
            "name": "Memories",
            "img": "assets/images/fabrication/memories.jpg",
            "id": "memories",
            "modalID": "memories-modal"
        },
        {
            "name": "Valetines",
            "img": "assets/images/fabrication/flower.jpg",
            "id": "flower",
            "modalID": "flower-modal"
        },
        {
            "name": "Dead, Dying, Plant",
            "img": "assets/images/fabrication/plants.jpg",
            "id": "plant",
            "modalID": "plant-modal"
        }
    ]     
}

var webDev = {
    "projects": [
        {
            "name": "Portfolio Website",
            "img": "assets/images/coding/website.png",
            "id": "website",
            "modalID": "website-modal"
        },
        {
            "name": "Waves",
            "img": "assets/images/coding/waves.png",
            "id": "floweer",
            "modalID": "waves-modal"
        },
        {
            "name": "P5 Experiments",
            "img": "assets/images/coding/p5-experiments.jpg",
            "id": "p5-experiments",
            "modalID": "p5-modal"
        }
        
    ]     
}

var drawing = {
    "projects": [
        {
            "name": "Within Our Reach",
            "img": "assets/images/fabrication/swing.jpg",
            "id": "swing",
            "modalID": "swing-modal"
        },
        {
            "name": "Enclosed",
            "img": "assets/images/fabrication/enclosed.jpg",
            "id": "enclosed",
            "modalID": "enclosed-modal"
        },
        {
            "name": "Memories",
            "img": "assets/images/fabrication/memories.jpg",
            "id": "memories",
            "modalID": "memories-modal"
        },
        {
            "name": "Valetines",
            "img": "assets/images/fabrication/flower.jpg",
            "id": "floweer",
            "modalID": "flower-modal"
        },
        {
            "name": "Dead, Dying, Plant",
            "img": "assets/images/fabrication/plants.jpg",
            "id": "plant",
            "modalID": "plant-modal"
        }
    ]     
}

var painting = {
    "projects": [
        {
            "name": "Within Our Reach",
            "img": "assets/images/fabrication/swing.jpg",
            "id": "swing",
            "modalID": "swing-modal"
        },
        {
            "name": "Enclosed",
            "img": "assets/images/fabrication/enclosed.jpg",
            "id": "enclosed",
            "modalID": "enclosed-modal"
        },
        {
            "name": "Memories",
            "img": "assets/images/fabrication/memories.jpg",
            "id": "memories",
            "modalID": "memories-modal"
        },
        {
            "name": "Valetines",
            "img": "assets/images/fabrication/flower.jpg",
            "id": "floweer",
            "modalID": "flower-modal"
        },
        {
            "name": "Dead, Dying, Plant",
            "img": "assets/images/fabrication/plants.jpg",
            "id": "plant",
            "modalID": "plant-modal"
        }
    ]     
}

var photography = {
    "projects": [
        {
            "name": "Within Our Reach",
            "img": "assets/images/fabrication/swing.jpg",
            "id": "swing",
            "modalID": "swing-modal"
        },
        {
            "name": "Enclosed",
            "img": "assets/images/fabrication/enclosed.jpg",
            "id": "enclosed",
            "modalID": "enclosed-modal"
        },
        {
            "name": "Memories",
            "img": "assets/images/fabrication/memories.jpg",
            "id": "memories",
            "modalID": "memories-modal"
        },
        {
            "name": "Valetines",
            "img": "assets/images/fabrication/flower.jpg",
            "id": "flower",
            "modalID": "flower-modal"
        },
        {
            "name": "Dead, Dying, Plant",
            "img": "assets/images/fabrication/plants.jpg",
            "id": "plant",
            "modalID": "plant-modal"
        }
    ]     
}

var animation = {
    "projects": [
        {
            "name": "Within Our Reach",
            "img": "assets/images/fabrication/swing.jpg",
            "id": "swing",
            "modalID": "swing-modal"
        },
        {
            "name": "Enclosed",
            "img": "assets/images/fabrication/enclosed.jpg",
            "id": "enclosed",
            "modalID": "enclosed-modal"
        },
        {
            "name": "Memories",
            "img": "assets/images/fabrication/memories.jpg",
            "id": "memories",
            "modalID": "memories-modal"
        },
        {
            "name": "Valetines",
            "img": "assets/images/fabrication/flower.jpg",
            "id": "floweer",
            "modalID": "flower-modal"
        },
        {
            "name": "Dead, Dying, Plant",
            "img": "assets/images/fabrication/plants.jpg",
            "id": "plant",
            "modalID": "plant-modal"
        }
    ]     
}



function fillPortfolioTemplate(category, idString="#portfolio", sourceElement="#portfolio-template"){
    //Code from Programmable User Interfaces Lab
    //get HTML template using jQuery
    var source = $(sourceElement).html();
    //compile the template into a function
    var template = Handlebars.compile(source);
    //create new HTML using our data
    var newHTML = template(category);
    //add the new HTML to the page
    $(idString).append(newHTML);

}

function onPortfolioImgHover(idString=".portfolio-img"){
    //Displays project title when hovering on project image in portfolio
    $(idString).on('mouseenter', 'img', function(event){
        $(this).fadeTo(200, 0);
        $(this).parent().children('h2').fadeTo(200, 1);
    }).on('mouseleave', 'img', function(event){
            $(this).fadeTo(200, 1);
            $(this).parent().children('h2').fadeTo(200, 0);
        });
};

function onPortfolioTitleHover(){
    //Displays project title when hovering on project image in portfolio
    var imgTitle;
    $(".design-project").on('mouseenter', function(event){
        imgTitle = "#" + this.id + "-img";
        $(imgTitle).css("z-index", "10");
        $(imgTitle).fadeTo(200, 1);
    }).on('mouseleave', function(event){
            
            $(imgTitle).fadeTo(200, 0);
            $(imgTitle).css("z-index", "3");
            
        });
};



// $(window).on('resize', function(){
//       var win = $(this);
//       if (win.width() <= 770) {$.fn.fullpage.setAutoScrolling(false);}
//       else {$.fn.fullpage.setAutoScrolling(true);}
// });



function windowSizeOptions(){
  var win = $(this);
  if (win.width() >= 600) {
    $('#fullpage').fullpage({
      autoScrolling: false,
      touchSensitivity: 10,
      scrollingSpeed: 800,
      navigation: true,
      navigationPosition: 'left',
      navigationTooltips: ['Home', 'UI/UX Design','Experimental', 'About', 'Connect'],
      anchors: ['home', 'ui-ux','experimental', 'about', 'connect'],
      scrollOverflow: false
    });
  }
  else {$('#fullpage').fullpage({
    autoScrolling: false,
    touchSensitivity: 10,
    scrollingSpeed: 800,
    navigation: false,
    navigationPosition: 'left',
    navigationTooltips: ['Home', 'UI/UX Design','Experimental', 'About', 'Connect'],
    anchors: ['home', 'ui-ux','experimental', 'about', 'connect'],
    scrollOverflow: false
    });
  }
}

function navBarLoad(clickID){
    //load the clicked category on the portfolio page
  $('#portfolio-content').stop(true).fadeTo(500, 0,
      function(){
          $('#portfolio').children('#portfolio-content').remove();
          console.log(clickID);
          if (clickID == 'fabrication'){
            fillPortfolioTemplate(fabrication);
            $('#portfolio-content').css('opacity', 0);
          }
          else if (clickID == 'd-fab'){
            fillPortfolioTemplate(dFab);
            $('#portfolio-content').css('opacity', 0);
          }
          else if (clickID == 'wood-metal'){
            fillPortfolioTemplate(woodMetal);
            $('#portfolio-content').css('opacity', 0);
          }
          else if (clickID == 'featured'){
            fillPortfolioTemplate(featured);
            $('#portfolio-content').css('opacity', 0);
          }
          else if (clickID == 'hardware'){
            fillPortfolioTemplate(hardware);
            $('#portfolio-content').css('opacity', 0);
          }
          else if (clickID == 'creative-frameworks'){
            fillPortfolioTemplate(creativeFrameworks);
            $('#portfolio-content').css('opacity', 0);
          }
          else if (clickID == 'web-dev'){
            fillPortfolioTemplate(webDev);
            $('#portfolio-content').css('opacity', 0);
          }
          else if (clickID == 'drawing'){
            fillPortfolioTemplate(drawing, "#2D-template");
            $('#portfolio-content').css('opacity', 0);
          }
          else if (clickID == 'painting'){
            fillPortfolioTemplate(painting, "#2D-template");
            $('#portfolio-content').css('opacity', 0);
          }
          else if (clickID == 'photography'){
            fillPortfolioTemplate(photography, "#2D-template");
            $('#portfolio-content').css('opacity', 0);
          }
          else if (clickID == 'animation'){
            fillPortfolioTemplate(animation, "#2D-template");
            $('#portfolio-content').css('opacity', 0);
          }

          $('#portfolio-content').stop(true).fadeTo(300, 1.0);
          onPortfolioImgHover(); 

          
      });
}

function navBarConfiguration(){
    //add click events to navBar to change active category and load content
  $('#portfolio .nav-link' ).on( 'click', function () {
    //references https://stackoverflow.com/questions/24514717/bootstrap-navbar-active-state-not-working
      $('#portfolio .navbar').find( '.active' ).removeClass( 'active' );
      $( this ).addClass( 'active' );
      if (this.id=="featured"){navBarLoad(this.id);}
    });
  $('#portfolio .dropdown-item' ).on( 'click', function () {
    //references https://stackoverflow.com/questions/24514717/bootstrap-navbar-active-state-not-working
    navBarLoad(this.id);
  });
}

function modalFreezePageScrolling(){
    //disable main page scrolling when modal is open
    $(".modal").on("hidden.bs.modal", function () {
        $.fn.fullpage.setAllowScrolling(true);
        $.fn.fullpage.setKeyboardScrolling(true);
      
        $("body").removeClass("modal-open")

        //unblur nav
        $("#fp-nav").css({
            "filter": "none",
            "transition": "0.3s"
        });
      

    });

    $(".modal").on("show.bs.modal", function (event) {


        $.fn.fullpage.setAllowScrolling(false);
        $.fn.fullpage.setKeyboardScrolling(false);

      
        $("body").addClass("modal-open");
        $('input').focus();

        //blur nav
        $("#fp-nav").css({
            "filter": "blur(2px)",
            "transition": "0.3s"
        });
    });
}

//from https://coderwall.com/p/i817wa/one-line-function-to-detect-mobile-devices-with-javascript
function isMobileDevice() {
    //console.log((typeof window.orientation !== "undefined") || (navigator.userAgent.indexOf('IEMobile') !== -1))
    return (typeof window.orientation !== "undefined") || (navigator.userAgent.indexOf('IEMobile') !== -1);
};

function onResize(){
    var win = $(this);
    //Desktop
    // if (win.width() >= 600) {


    
    if (!isMobileDevice()){
        $('#fp-nav').css('display', 'block');

        $('#ui-ux-desktop').css('display', 'block');
        $('#ui-ux-mobile').css('display', 'none');

        $('#experimental-mobile').css('display', 'none');
        $('#experimental-desktop').css('display', 'block');

        $('#about-placeholder').css('display', 'block');
    }
    //Touch Screen
    else{
        $('#fp-nav').css('display', 'none');

        $('#ui-ux-desktop').css('display', 'none');
        $('#ui-ux-mobile').css('display', 'block');

        $('#experimental-mobile').css('display', 'block');
        $('#experimental-desktop').css('display', 'none');

        $('#about-profile').css('font-weight', '300')
    
    }
    //Remove about image if screen is too narrow
    if (win.width() <= 750){
        $('#about-placeholder').css('display', 'none');
    }
    else{
        $('#about-placeholder').css('display', 'block');
    }

    //if portrait, make about text wide
    if (win.height() + 220 > win.width()){
        $( "#about-profile" ).removeClass( "col-md-4" ).addClass( "col-md-8" );
    }
    else{
        $( "#about-profile" ).removeClass( "col-md-8" ).addClass( "col-md-4" );
    }
}

function carouselOptions(){

    //setup Flickity Carousel
    $('.carousel-container').each( function( i, container ) {
        
        var $container = $( container );


        // var $carousel = $container.find('#ui-ux-mobile.main-gallery').flickity({
        //   // options
        //     cellSelector: '.gallery-cell',
        //     imagesLoaded: true,
        //     prevNextButtons: false,
        //     wrapAround: true
        // });
        if($container.find('.main-gallery').hasClass('desktop')){
            var $carousel = $container.find('.main-gallery').flickity({
              // options
                cellSelector: '.gallery-cell',
                imagesLoaded: true,
                prevNextButtons: false,
                wrapAround: false
            });

        }
        else{
            var $carousel = $container.find('.main-gallery').flickity({
              // options
                cellSelector: '.gallery-cell',
                imagesLoaded: true,
                prevNextButtons: false,
                wrapAround: true
            });
        }

        //Load modal if center carousel is clicked, 
        //change selected modal if left or right is clicked
        $('.modal-link').on('click', function(){
            if ($(this).hasClass('is-selected')){
                $('#theModal').modal('show');
                $('#myModalContent').load('assets/html/' +this.getAttribute('modal') + '.html');
             }
             else{
                var index = $(this).index();
                setTimeout(function() {
                    $carousel.flickity( 'select', index );
                }, 5);
             }

             
         });

            
            


        // Flickity instance
        $carousel.on( 'select.flickity', function(event, index) {
//data-target=#theModal
            //add modal click options
            
            


          // set image caption using img's alt
          var flkty = $carousel.data('flickity');
          var caption = $container.find('.caption');
          var elem = flkty.selectedElement;
          caption.text(elem.getAttribute("alt"));

          var description = $container.find('.description');
            description.text(elem.getAttribute("desc"));
        });

        //no vertical scroll on carousel swipe

        $carousel.on( 'dragStart.flickity', function( event, pointer ) {
        document.ontouchmove = function (e) {
            e.preventDefault();
        }
        });
        $carousel.on( 'dragEnd.flickity', function( event, pointer ) {
            document.ontouchmove = function (e) {
                return true;
            }
        });

    });
}

$( document ).ready(function() {


    carouselOptions();
    windowSizeOptions();
    onResize();

    $(window).on('resize', function(){
        onResize();
    });
    //sticky detail page header
    $('.modal').scroll(function(){ 
        var pxToTop = $(this).scrollTop();                         
        if ($(this).scrollTop() > 5) {
            $('.modal-header').css({
              'border-radius': '0',
              'box-shadow': '0px 2px 8px rgb(0, 0, 0, 0.5)',
              'background-color': '#191C22',
              'transition': '0.2s',
              'opacity': '1'

              });

        } else {
            $('.modal-header').css({
              'border-radius': '20px 20px 0px 0px',
              'box-shadow': 'none',
              'background-color': '#121924',
              'transition': '0.2s'

            });
        }
    });
    navBarConfiguration();
    modalFreezePageScrolling();
    $(document).on('hidden.bs.modal', function (event) {
        if ($('.modal:visible').length) {
            $('body').addClass('modal-open');
        }
    });

        // $('modal-link').on('click', function(event){
        //     event.stopPropagation();
        // });

    onPortfolioTitleHover();
    $("#connect-icons").on('mouseenter', '#email', function(event){
        $('#email p').fadeTo(500, 1.0);
    });

    //focus searchbar when searching modal is clicked
    $('#theModal').on('shown.bs.modal', function () {

        $('input').focus();

    });
    
    //fade in home screen
    $('body').removeClass('fade-out');

 });



